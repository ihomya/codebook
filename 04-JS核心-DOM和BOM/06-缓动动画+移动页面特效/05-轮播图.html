<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        ul,
        ol {
            list-style: none;
        }

        .focus {
            position: relative;
            margin: 50px auto 0;
            width: 721px;
            height: 455px;
            background-color: pink;
            overflow: hidden;
        }

        .focus ul {
            position: absolute;
            top: 0;
            left: 0;
            width: 600%;
        }

        .focus ul li {
            float: left;
        }

        .focus ul li img {
            vertical-align: middle;
        }

        .arrow-l,
        .arrow-r {
            display: none;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 24px;
            height: 40px;
            background-color: rgba(0, 0, 0, .3);
            text-align: center;
            line-height: 40px;
            color: #fff;
            z-index: 1;
        }

        .arrow-r {
            right: 0;
        }

        .circle {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            /* width: 100px; */
            height: 12px;
            /* background-color: pink; */

        }

        .circle li {
            float: left;
            width: 12px;
            height: 12px;
            margin-right: 5px;
            border: 1px solid #fff;
            border-radius: 6px;
            cursor: pointer;
        }

        .circle li:last-child {
            margin-right: 0;
        }

        .circle li.current {
            background-color: #fff;
        }
    </style>
    <script src="./animate.js"></script>
    <script>
        window.addEventListener('load', function () {
            // 1. è·å–å…ƒç´ 
            var focus = document.querySelector('.focus');
            var arrow_l = document.querySelector('.arrow-l')
            var arrow_r = document.querySelector('.arrow-r');
            // è·å–ç›’å­å®½åº¦
            var focusWidth = focus.offsetWidth;
            // 2. é¼ æ ‡ç»è¿‡focus ç®­å¤´æ˜¾ç¤ºéšè—
            focus.addEventListener('mouseenter', function () {
                arrow_l.style.display = 'block';
                arrow_r.style.display = 'block';
                clearInterval(timer);
                timer = null; // åœæ­¢è‡ªåŠ¨æ’­æ”¾
            })
            focus.addEventListener('mouseleave', function () {
                arrow_l.style.display = 'none';
                arrow_r.style.display = 'none';
                timer = setInterval(function () {
                    // æ‰‹åŠ¨è°ƒç”¨äº‹ä»¶
                    arrow_r.click();
                }, 2000);
            });
            // 3. åŠ¨æ€ç”Ÿæˆå°åœ†åœˆ æœ‰å‡ å¼ å›¾å°±ç”Ÿæˆå‡ ä¸ª
            var ul = focus.querySelector('ul');
            var ol = focus.querySelector('ol');
            for (var i = 0; i < ul.children.length; i++) {
                // åˆ›å»ºä¸€ä¸ªli
                var li = document.createElement('li');

                // è®°å½•å½“å‰å°åœ†åœˆçš„ç´¢å¼•å·ï¼Œé€šè¿‡æ·»åŠ è‡ªå®šä¹‰å±æ€§ index
                li.setAttribute('index', i);

                // æ·»åŠ liåˆ°ol
                ol.appendChild(li);
                // 4. æ³¨å†Œç‚¹å‡»äº‹ä»¶ æ¸…é™¤æ‰€æœ‰å°liçš„currentç±»å ç»™ç‚¹å‡»çš„liæ·»åŠ current
                li.addEventListener('click', function () {
                    for (var i = 0; i < ol.children.length; i++) {
                        ol.children[i].className = '';
                    }
                    this.className = 'current';
                    // 5. ç‚¹å‡»å°åœ†åœˆï¼Œç§»åŠ¨å›¾ç‰‡ï¼Œé€šè¿‡ç§»åŠ¨ul
                    // ulçš„ç§»åŠ¨è·ç¦» å°åœ†åœˆçš„ç´¢å¼•å· ä¹˜ä»¥ å›¾ç‰‡çš„å®½åº¦ æ³¨æ„æ˜¯è´Ÿå€¼
                    // è·å–indexå€¼
                    var index = this.getAttribute('index');
                    num = index;
                    circle = index;
                    animate(ul, - index * focusWidth);
                });
            };
            // æŠŠolé‡Œé¢çš„ç¬¬ä¸€ä¸ªliè®¾ç½®ç±»åä¸º current
            ol.children[0].className = 'current';
            // 6. å…‹éš†ç¬¬ä¸€å¼ å›¾
            var first = ul.children[0].cloneNode(true);
            ul.appendChild(first);
            // 7. ç‚¹å‡»å³ä¾§æŒ‰é’® å›¾ç‰‡æ»šåŠ¨ä¸€å¼ 
            var num = 0;
            // circle æ§åˆ¶å°åœ†åœˆæ’­æ”¾
            var circle = 0;
            // èŠ‚æµé˜€: é˜²æ­¢ç‚¹å‡»è¿‡å¿«
            var flag = true;
            arrow_r.addEventListener('click', function () {
                if (flag) {
                    flag = false; // å…³é—­èŠ‚æµé˜€
                    // å¦‚æœèµ°åˆ°æœ€åä¸€å¼ ï¼Œulè¦å¿«é€Ÿå¤åŸ å°†leftè®¾ç½®ä¸º0 å®ç°æ— ç¼æ»šåŠ¨
                    if (num == ul.children.length - 1) {
                        ul.style.left = 0;
                        num = 0;
                    }
                    num++;
                    animate(ul, - num * focusWidth, function () {
                        flag = true; // æ‰“å¼€èŠ‚æµé˜€
                    });
                    // 8. ç‚¹å‡»æŒ‰é’® è‡ªå¢1
                    circle++;
                    if (circle == ol.children.length) {
                        circle = 0;
                    }
                    circleChange();
                }
            });
            arrow_l.addEventListener('click', function () {
                if (flag) {
                    flag = false;
                    // å¦‚æœèµ°åˆ°æœ€åä¸€å¼ ï¼Œulè¦å¿«é€Ÿå¤åŸ å°†leftè®¾ç½®ä¸º0 å®ç°æ— ç¼æ»šåŠ¨
                    if (num == 0) {
                        num = ul.children.length - 1;
                        ul.style.left = -num * focusWidth + 'px';
                    }
                    num--;
                    animate(ul, - num * focusWidth, function () {
                        flag = true;
                    });
                    // 8. ç‚¹å‡»æŒ‰é’® è‡ªå¢1
                    circle--;
                    if (circle < 0) {
                        circle = ol.children.length - 1;
                    }
                    circleChange();
                }

            });
            // å°åœ†åœˆæ’ä»–å‡½æ•°
            function circleChange() {
                // å°åœ†åœˆ æ’ä»–
                for (var i = 0; i < ol.children.length; i++) {
                    ol.children[i].className = '';
                }
                ol.children[circle].className = 'current';
            }
            // 9. è‡ªåŠ¨æ’­æ”¾ ä¸å³ç®­å¤´æŒ‰é’®åŠŸèƒ½ç›¸åŒ
            var timer = setInterval(function () {
                // æ‰‹åŠ¨è°ƒç”¨äº‹ä»¶
                arrow_r.click();
            }, 2000);
        })
    </script>
</head>

<body>
    <div class="focus">
        <!-- å·¦ä¾§æŒ‰é’® -->
        <a href="javascript:void(0);" class="arrow-l">ğŸ‘ˆ</a>
        <!-- å³ä¾§æŒ‰é’® -->
        <a href="javascript:void(0);" class="arrow-r">ğŸ‘‰</a>
        <!-- æ ¸å¿ƒæ»šåŠ¨åŒºåŸŸ -->
        <ul>
            <li><a href="javascript:void(0);"><img src="./upload/focus.jpg" alt=""></a></li>
            <li><a href="javascript:void(0);"><img src="./upload/focus1.jpg" alt=""></a></li>
            <li><a href="javascript:void(0);"><img src="./upload/focus2.jpg" alt=""></a></li>
            <li><a href="javascript:void(0);"><img src="./upload/focus3.jpg" alt=""></a></li>
        </ul>
        <!-- å°åœ†åœˆ -->
        <ol class="circle">
        </ol>
    </div>
</body>

</html>